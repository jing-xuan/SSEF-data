<!Doctype html>
<meta name="viewport" content="width=device-width" />
<html>
<head>
  <title>SSEF Submissions</title>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Ubuntu|Open+Sans" rel="stylesheet">
  <style>
    h1, h3{
      font-family: 'Ubuntu', sans-serif;
    }
    h1{
      padding-left: 5px;
    }
    h3{
      padding-left: 15px;
    }
    .data{
      font-family: 'Open Sans', sans-serif;
      width: 450px;
      padding-bottom: 5px;
      padding-left: 15px;
      display: inline;
    }
    body{
      width: 95%
      padding-left: 2.5%;
    }
    .bar{
      height: 15px;
      background-color: blue;
      display: inline-block;
      position: relative;
    }
    .bar:hover{
      height: 20px;
    }
    .bar:hover .tooltip{
      visibility: visible;
    }
    #schoolList{
      padding-left: 15px;
    }
    .chart{
      display: inline-block;
    }
    .tooltip{
      visibility: hidden;
      width: 60px;
      text-align: center;
      border-style: solid;
      border-width: 1px;
      top: 115%;
      position: absolute;
    }
    #projList td{
      border-style: solid;
      border-width: 1px;
      font-family: 'Open Sans';
      padding-left: 5px;
      padding-right: 5px;
    }
    #projList{
      padding-left: 15px;
    }
    .clicked{
      background-color: steelblue;
    }
  </style>
</head>
<body>
  <script>
    $(document).ready(function(){
      var max = 0;
      <% for(var i=0; i<schList.length; i++){%>
        if(<%= all[i]["total"] %> > max){
          max = <%=all[i]["total"] %>;
        }
        var div = $("<div class = 'data'></div>");
        var txt = $("<p></p>").text('<%= all[i]["school"] %>');
        div.append(txt);
        var fullBar = $("<div class = 'chart' style = ''></div>");
        <% for(var j=0; j<c.length; j++){%>
          <% if(all[i]["cat"].indexOf(c[j]) != -1){%>
            var bar = $("<div class = 'bar' style = ''></div>");
            bar.width(<%= all[i]["catTotal"][all[i]["cat"].indexOf(c[j])] %>*10);
            bar.css("background-color", "<%= col[j] %>");
            var tooltip = $("<span class = 'tooltip' style = 'border-color: <%= col[j] %>;'><%= c[j] %> : <%= all[i]['catTotal'][all[i]['cat'].indexOf(c[j])] %></span>");
            bar.append(tooltip);
            fullBar.append(bar);
          <%}%>
        <%}%>
        fullBar.append("&nbsp;&nbsp;&nbsp;<%= all[i]['total'] %>");
        div.append(fullBar);
        if('<%= all[i]["school"] %>' != ""){
          $("#schoolList").append(div);
        }
        $("#schoolList").width(max*10);
      <%}%>
      <% for(var j=0; j<c.length; j++){%>
        <% for(var i=0; i<nush.length; i++){%>
          if("<%= nush[i]['category1'] %>" == '<%= c[j] %>'){
            var txt = "<tr class = 'p'><td><%= nush[i]['category1'] %>";
            if(<%= nush[i]['projectCode'].length %> == 1){
              txt += "00<%= nush[i]['projectCode'] %></td>";
            }else if(<%= nush[i]['projectCode'].length %> == 2){
              txt += "0<%= nush[i]['projectCode'] %></td>";
            }else if(<%= nush[i]['projectCode'].length %> == 3){
              txt += "<%= nush[i]['projectCode'] %></td>";
            }
            txt += "<td><%= nush[i]['title'] %></td></tr>";
            $("#projList").append(txt);
          }
        <%}%>
      <%}%>
      $('.p').click(function(){
        $(this).toggleClass('clicked');
      });
    });
  </script>
  <h1>Total number of SSEF Submissions: <%= raw.length %></h1>
  <h3>Submission by School: </h3>
  <div id = "schoolList"></div>
  <br>
  <h3>NUSH Project List</h3>
  <div id = "projList">
    <table id = "nushprj">
    </table>
  </div>
</body>
</html>
